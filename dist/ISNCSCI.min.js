var ISNCSCI=function(e){"use strict";var r=["C5","C6","C7","C8","T1","L2","L3","L4","L5","S1"],n=["C1","C2","C3","C4","C5","C6","C7","C8","T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","T11","T12","L1","L2","L3","L4","L5","S1","S2","S3","S4_5"],i=function(e){return["0","1","0*","1*"].includes(e)},t=function(e){return["0**","1**"].includes(e)},l=function(e){return["2","NT","NT**"].includes(e)},u=function(e,r,n,u){if("C1"===n)throw"invalid arguments level: "+r+" nextLevel: "+n;if("2"===e.lightTouch[n]&&"2"===e.pinPrick[n])return{continue:!0,variable:u};if(i(e.lightTouch[n])||i(e.pinPrick[n]))return{continue:!1,level:r+(u?"*":""),variable:u};if([e.lightTouch[n],e.pinPrick[n]].includes("NT*"))return{continue:!1,level:r+"*",variable:!0};if("NT"===e.lightTouch[n]||"NT"===e.pinPrick[n]){if(t(e.lightTouch[n])||t(e.pinPrick[n]))return{continue:!0,level:r+(u?"*":""),variable:!0};if(l(e.lightTouch[n])||l(e.pinPrick[n]))return{continue:!0,level:r+(u?"*":""),variable:u};throw""}return{continue:!0,variable:!0}},o=function(e){for(var r=[],i=!1,t=0;t<n.length;t++){var l=n[t],o=n[t+1];if(o){var a=u(e,l,o,i);if(i=i||!!a.variable,a.level&&r.push(a.level),a.continue)continue;break}r.push("INT"+(i?"*":""))}return r.join(",")},a=function(e){return["0","NT","0*","NT*"].includes(e)},c=function(e){return["2","NT**","0**","1**"].includes(e)},v=function(e,r,i){return e>=n.indexOf(r)&&e<=n.indexOf(i)},f=function(e,r,n,i){if(["0","1","2"].includes(e.motor[r]))throw new Error("Invalid motor value at current level");var t={continue:!1,variable:i};return["0","1","2"].includes(e.motor[r])||["0*","1*","2*","NT*","3","4","3*","4*"].includes(e.motor[r])||["0","1","2"].includes(e.motor[n])||(t.continue=!0),["5","0**","1**","2**","3**","4**","NT**"].includes(e.motor[r])&&!["0","1","2","0*","1*","2*","NT","NT*"].includes(e.motor[n])||(["0*","1*","2*","NT*"].includes(e.motor[r])||["0**","1**","2**"].includes(e.motor[r])&&["0*","1*","2*","NT","NT*"].includes(e.motor[n])?t.level=r+"*":t.level=r+(i?"*":"")),["5","3","4","3*","4*","NT"].includes(e.motor[r])?"5"===e.motor[r]&&["0**","1**","2**"].includes(e.motor[n])&&(t.variable=!0):["0**","1**","2**","3**","4**","NT**"].includes(e.motor[r])&&["0","1","2"].includes(e.motor[n])||(t.variable=!0),t},s=function(e,r,n,i){return{continue:!["0","1","2"].includes(e.motor[n]),level:["0","1","2","0*","1*","2*","NT","NT*"].includes(e.motor[n])?r+(i?"*":""):void 0,variable:i||["0**","1**","2**"].includes(e.motor[n])}},h=function(e,r,i){if(["0","1","2"].includes(e.motor[r]))throw new Error("Invalid motor value at current level");return function(e,r,n,i){var t={continue:!0,variable:n};return!["3","4","0*","1*","2*","3*","4*","NT*"].includes(e.motor[r])&&i.continue||(t.continue=!1),"NT"!==e.motor[r]&&["5","0**","1**","2**","3**","4**","NT**"].includes(e.motor[r])&&i.continue&&!i.level||(["0*","1*","2*","NT*"].includes(e.motor[r])||["0**","1**","2**"].includes(e.motor[r])&&(i.level||!i.continue)?t.level=r+"*":t.level=r+(n?"*":"")),(["0*","1*","2*","NT*","0**","1**","2**"].includes(e.motor[r])||["3**","4**","NT**"].includes(e.motor[r])&&i.continue||["5","NT"].includes(e.motor[r])&&i.continue&&i.variable&&!i.level)&&(t.variable=!0),t}(e,r,i,function(e,r){for(var i=n.indexOf(r)-1,t={continue:!0,variable:!1},l=i;l<=i+5;l++){var o=n[l],a=n[l+1],c=u(e,o,a,!1);!1===c.continue&&(t.continue=!1),c.level&&(t.level=c.level),c.variable&&(t.variable=!0)}return t}(e,"T1"===r?"C5":"L2"))},T=function(e){for(var i,t,l,o=[],a=!1,c=0;c<n.length;c++){if(i=n[c],t=n[c+1],v(c,"C1","C3")||v(c,"T2","T12")||v(c,"S2","S3"))l=u(e,i,t,a);else if("C4"===i||"L1"===i)l=s(e,i,t="C4"===i?"C5":"L2",a);else if(v(c,"C5","C8")||v(c,"L2","L5")){var T=c-(v(c,"C5","C8")?4:16);i=r[T],t=r[T+1],l=f(e,i,t,a)}else l="T1"===i||"S1"===i?h(e,i,a):{continue:!1,level:"INT"+(a?"*":""),variable:a};if(a=a||l.variable,l.level&&o.push(l.level),!l.continue)return o.join(",")}return o.join(",")};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
function d(){for(var e=0,r=0,n=arguments.length;r<n;r++)e+=arguments[r].length;var i=Array(e),t=0;for(r=0;r<n;r++)for(var l=arguments[r],u=0,o=l.length;u<o;u++,t++)i[t]=l[u];return i}var p=function(e){return"0"===e},g=function(e,r,n){if("C1"===r)throw"invalid argument level: "+r;var i=p(e.pinPrick[r]),t=p(e.lightTouch[r]);if(i&&t)return{continue:!0,variable:n};if(a(e.pinPrick[r])&&a(e.lightTouch[r])){var l=[e.pinPrick[r],e.lightTouch[r]].some((function(e){return["NT","NT*"].includes(e)}));return l?{continue:!0,level:r+(n?"*":""),variable:n}:{continue:!0,level:r+"*",variable:n||!l}}return{continue:!1,level:r+(n?"*":""),variable:n}},N=function(e,r){var i=[],t=!1;if(("No"===r||"NT"===r)&&a(e.lightTouch.S4_5)&&a(e.pinPrick.S4_5)){var l=g(e,"S4_5",t);"NT"!==r&&("No"!==r||l.continue&&void 0===l.level)||i.push("NA");for(var u=[],o=n.indexOf("S3");o>=0;o--){var c=n[o];if(o>0){var v=g(e,c,t);if(t=t||v.variable,v.level&&u.unshift(v.level),v.continue)continue;break}u.unshift(c)}return(i=d(i,u)).join(",")}return"NA"},b=function(e){return["5","NT","0**","1**","2**","3**","4**","NT**"].includes(e)},m=function(e){return["2","NT","0**","1**","NT**"].includes(e)},C=function(e,r,n){var i={continue:!0,variable:n};return"0"===e.motor[r]?i:(["0*","NT","NT*"].includes(e.motor[r])||(i.continue=!1),["0*","0**"].includes(e.motor[r])?i.level=r+"*":i.level=r+(n?"*":""),["0*","0**"].includes(e.motor[r])&&(i.variable=!0),i)},S=function(e,r,n,i,t,l){if("C1"===r)throw"invalid argument level: "+r;var u={continue:!0,variable:!1},o=m(e.lightTouch[r]),a=m(e.pinPrick[r]);return o&&a?t?((i||l||"NT"===e.lightTouch[r]||"NT"===e.pinPrick[r])&&(u.level=r+(n?"*":""),i&&"NT"!==e.lightTouch[r]&&"NT"!==e.pinPrick[r]&&(u.continue=!1)),u):"NT"!==e.lightTouch[r]||"NT"!==e.pinPrick[r]?{continue:!0,variable:n}:"NT"===e.lightTouch[r]||"NT"===e.pinPrick[r]?{continue:!0,level:r+(n?"*":""),variable:n}:{continue:!1,level:r+(n?"*":""),variable:n}:{continue:!0,variable:n}},k=function(e,i){var t,l,u;switch(i){case"upper":t=r.indexOf("C5"),l=n.indexOf("C5");break;case"lower":t=r.indexOf("L2"),l=n.indexOf("L2");break;default:throw"invalid option"}for(var o=t;o<t+5;o++){var a=r[o];if(u=e.motor[a],!["5","0**","1**","2**","3**","4**","NT**"].includes(u))return!1}for(o=l;o<l+5;o++){if("C1"===(a=n[o])||!c(e.pinPrick[a])||!c(e.lightTouch[a]))return!1}return!0},P=function(e,i){var t,l;switch(i){case"upper":t=r.indexOf("C5"),l=n.indexOf("C5");break;case"lower":t=r.indexOf("L2"),l=n.indexOf("L2");break;default:throw"invalid option"}for(var u=t;u<t+5;u++){var o=r[u];if(!b(e.motor[o]))return!1}for(u=l;u<l+5;u++){if("C1"===(o=n[u])||!m(e.pinPrick[o])||!m(e.lightTouch[o]))return!1}return!0},x=function(e,n){var i,t;switch(n){case"upper":i=r.indexOf("C5");break;case"lower":i=r.indexOf("L2");break;default:throw"invalid option"}for(var l=i;l<i+5;l++){var u=r[l];if(t=e.motor[u],!["0","0*","NT","NT*"].includes(t))return!1}return!0},L=function(e,n){var i;switch(n){case"upper":i=r.indexOf("C5");break;case"lower":i=r.indexOf("L2");break;default:throw"invalid option"}for(var t=i;t<i+5;t++){var l=r[t];if(["0","1","2","3","4","0*","1*","2*","3*","4*"].includes(e.motor[l]))return!0}return!1},w=function(e,i,t,l){for(var u=-1,o=!1,a="upper"===l?r.indexOf("T1"):r.length-1,c="upper"===l?0:r.indexOf("L2"),v=a;v>=c;v--){var f=r[v];if(t=C(e,f,o),o=o||t.variable,t.level&&i.unshift(t.level),!t.continue){u=-1;break}u=n.indexOf(f)}return u},O=function(e,i){if("Yes"===i)return"NA";var t=[],l=function(e){for(var i={continue:!0,level:"S4_5",variable:!1},t=n.indexOf("C2");t<n.length;t++)if(v(t,"C5","T1")||v(t,"L2","S1")){var l=t-(v(t,"C5","T1")?4:16),u=r[l];if(("0**"===e.motor[u]||["0**","1**","NT**"].includes(e.lightTouch[u])||["0**","1**","NT**"].includes(e.pinPrick[u]))&&(i.variable=!0),!b(e.motor[u])||!m(e.lightTouch[u])||!m(e.pinPrick[u])){i.level=n[t-1];break}}else{if("C1"===(u=n[t]))throw"invalid argument level: "+u;if((["0**","1**","NT**"].includes(e.lightTouch[u])||["0**","1**","NT**"].includes(e.pinPrick[u]))&&(i.variable=!0),!m(e.lightTouch[u])||!m(e.pinPrick[u])){i.level=n[t-1];break}}return i}(e),u=k(e,"upper"),o=k(e,"lower"),a=P(e,"upper"),c=P(e,"lower"),f=x(e,"upper"),s=x(e,"lower"),h=[],T=void 0,p={continue:!0,variable:!1};if(("NT"===i||"No"===i&&"S4_5"===l.level)&&(t.push("NA"),p=S(e,"S4_5",!1,o,a&&c,!1)),e.lowestNonKeyMuscleWithMotorFunction&&function(e,r){if(r){var i=e.map((function(e){return n.indexOf(e.replace(/\*/,""))})),t=n.indexOf(r);return i.every((function(e){return e<=t}))}return!1}(h,e.lowestNonKeyMuscleWithMotorFunction))return e.lowestNonKeyMuscleWithMotorFunction;var g=function(e){for(var i=r.length-1;i>=0;i--){var t=r[i];if("0"!==e.motor[t])return"S1"===t?n.indexOf("S3"):"T1"===t?n.indexOf("L1"):n.indexOf(t)}return n.indexOf("S3")}(e),N=l.variable;(L(e,"lower")||L(e,"upper"))&&(g=w(e,h,p,"lower")),g>=0&&L(e,"upper")&&(g=w(e,h,p,"upper"));for(var O=g;O>=0&&p.continue;O--){if(T=n[O],v(O,"C2","C4"))(p=S(e,T,N,!0,!0,f)).level&&(f=!1);else if(v(O,"T2","L1"))(p=S(e,T,N,u,a,s)).level&&(s=!1);else if(v(O,"S2","S3"))p=S(e,T,N,o,a&&c,!1);else if(v(O,"C5","T1")||v(O,"L2","S1")){var y=O-(v(O,"C5","T1")?4:16);T=r[y],p=C(e,T,N)}else p={continue:!1,level:"C1",variable:!1};p.level&&h.unshift(p.level),N=N||p.variable}return(t=d(t,h.sort((function(e,r){return n.indexOf(e.replace(/\*/,""))-n.indexOf(r.replace(/\*/,""))})))).join(",")},y=function(e,r,n,i){var t;return(r.level||n.level)&&(t=r.level&&n.level&&r.level.includes("*")&&n.level.includes("*")?e+"*":e+(i?"*":"")),{continue:r.continue&&n.continue,level:t,variable:i||r.variable||n.variable}},_=function(e,i,t,l){if(t.continue){var u=n.indexOf(i),o=u-(v(u,"C4","T1")?4:16),a=r[o],c=r[o+1],h="C4"===i||"L1"===i?s(e.left,i,c,l):f(e.left,a,"T1"===i||"S1"===i?a:c,l),T="C4"===i||"L1"===i?s(e.left,i,c,l):f(e.right,a,"T1"===i||"S1"===i?a:c,l),d=void 0;return(h.level||T.level||t.level)&&(d=h.level&&T.level&&h.level.includes("*")&&T.level.includes("*")?i+"*":i+(l?"*":"")),{continue:h.continue&&T.continue,level:d,variable:l||t.variable||h.variable||T.variable}}return t},A=function(e){return v(e,"C2","C4")?0:v(e,"C5","T1")?e-4:v(e,"T2","L1")?5:v(e,"L2","S1")?e-16:r.length},I=function(e){var r=[e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5];return{result:"No"!==e.deepAnalPressure||"0"!==e.right.lightTouch.S4_5||"0"!==e.right.pinPrick.S4_5||"0"!==e.left.lightTouch.S4_5||"0"!==e.left.pinPrick.S4_5,variable:"No"===e.deepAnalPressure&&!r.every((function(e){return"0"===e}))&&r.every((function(e){return["0","0*","0**"].includes(e)}))}},E=function(e,i){for(var t,l=!1,u=0,o=i.split(",");u<o.length;u++){for(var a=o[u],c=n.indexOf(a.replace("*",""))+4,v=!0,f=A(c);f<r.length;f++){var s=r[f];if("0*"!==e[s]&&"0**"!==e[s]||(l=!0),t=e[s],!["0","NT","NT*","0*"].includes(t)){v=!1,"0*"===e[s]&&(l=!0);break}}if(v)return{result:!0,variable:l}}return{result:!1,variable:!1}},j=function(e,r){var n=I(e),i=function(e,r){var n=E(e.left.motor,r.motorLeft),i=E(e.right.motor,r.motorRight);return{result:"Yes"!==e.voluntaryAnalContraction&&i.result&&n.result,variable:"No"===e.voluntaryAnalContraction&&(n.variable||i.variable)}}(e,r);return{result:n.result&&i.result,variable:n.variable||i.variable}},D=function(e){return["0","1","2","NT","NT*"].includes(e)},M=function(e){return["0*","1*","2*"].includes(e)},R=function(e,i,t){var l=function(e,i){for(var t=0,l=i.replace(/\*/g,"").split(",");t<l.length;t++){for(var u=l[t],o=n.indexOf(u),a=A(o+1),c=r.length-a,v=0,f=0,s=a;s<r.length;s++){var h=r[s];if(D(e.left.motor[h])?v++:M(e.left.motor[h])&&(v++,f++),D(e.right.motor[h])?v++:M(e.right.motor[h])&&(v++,f++),v-f>c)return{result:!0,variable:!1}}if(v>c&&v-f<=c)return{result:!0,variable:!0}}return{result:!1,variable:!1}}(e,i);if(l.result)return l.variable||t.variable?"C*":"C"},Y=function(e){return!["0","1","2"].includes(e)},F=function(e){return["0*","1*","2*","0**","1**","2**"].includes(e)},K=function(e,i,t){var l=function(e,i){for(var t={result:!1,variable:!1},l=0,u=i.replace(/\*/g,"").split(",");l<u.length;l++){var o=u[l],a=n.indexOf(o),c=A(a+1),v=r.length-c;if(0===v)return{result:!0,variable:!1};for(var f=0,s=0,h=c;h<r.length;h++){var T=r[h];if(f+=Y(e.left.motor[T])?1:0,f+=Y(e.right.motor[T])?1:0,s+=F(e.left.motor[T])?1:0,f-(s+=F(e.right.motor[T])?1:0)>=v)return{result:!0,variable:!1}}f>=v&&(t.result=!0,t.variable=t.variable||f-s<v)}return t}(e,i);if(l.result)return l.variable||t.variable?"D*":"D"},W=function(e,i){for(var t=!1,l=0,u=i.split(",");l<u.length;l++)for(var o=u[l],a=n.indexOf(o.replace("*",""))+4,c=A(a);c<r.length;c++){var v=r[c];if("0**"===e[v]&&(t=!0),"0"!==e[v])return{result:!0,variable:t}}return{result:t,variable:t}},B=function(e,r,n,i){if("INT"===i)return"E";if("INT*"===i)return"E*";var t=[],l=function(e){if(function(e){return e.includes("C")}(e))return e.includes("*")?"A*":"A"}(r);l&&t.push(l);var u=function(e,r){var n=j(e,r);if(n.result)return n.variable?"B*":"B"}(e,n);u&&t.push(u);var o=function(e,r){var n={result:!1,variable:!1};if(function(e){return"No"!==e.voluntaryAnalContraction}(e))return n.result=!0,n;if(I(e).result){var i=W(e.right.motor,r.motorRight),t=W(e.left.motor,r.motorLeft);(i.result||t.result)&&(n.result=!0,(i.variable||t.variable)&&(n.variable=!0))}return n}(e,n);if(o.result){var a=R(e,i,o);a&&t.push(a);var c=K(e,i,o);c&&t.push(c)}var v=function(e){return e.includes("INT*")?"E*":e.includes("INT")?"E":void 0}(i);return v&&t.push(v),t.join(",")},z=function(e){var r=function(e){return{sensoryRight:o(e.right),sensoryLeft:o(e.left),motorRight:T(e.right),motorLeft:T(e.left)}}(e),i=function(e){for(var r=[],i=!1,t=0;t<n.length;t++){var l=n[t],o=n[t+1],a={continue:!0,variable:!1};if(o){var c=u(e.left,l,o,i),f=u(e.right,l,o,i);if(v(t,"C4","T1")||v(t,"L1","S1")){var s=y(l,c,f,i);a=_(e,l,s,i)}else a=y(l,c,f,i);if(i=i||a.variable,a.level&&r.push(a.level),!a.continue)break}else r.push("INT"+(i?"*":""))}return r.join(",")}(e),t=function(e){var r=a(e.right.lightTouch.S4_5),n=a(e.right.pinPrick.S4_5),i=a(e.left.lightTouch.S4_5),t=a(e.left.pinPrick.S4_5);if("Yes"!==e.voluntaryAnalContraction&&"Yes"!==e.deepAnalPressure&&r&&n&&i&&t){if("No"===e.voluntaryAnalContraction&&"No"===e.deepAnalPressure){if([e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return"0"===e})))return"C";if([e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return["0","0*"].includes(e)})))return"C*,I*"}return"C,I"}return"No"===e.voluntaryAnalContraction&&"No"===e.deepAnalPressure&&[e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return["0","0**"].includes(e)}))?"I*":"I"}(e);return{neurologicalLevels:r,neurologicalLevelOfInjury:i,injuryComplete:t,ASIAImpairmentScale:B(e,t,r,i),zoneOfPartialPreservations:function(e){return{sensoryRight:N(e.right,e.deepAnalPressure),sensoryLeft:N(e.left,e.deepAnalPressure),motorRight:O(e.right,e.voluntaryAnalContraction),motorLeft:O(e.left,e.voluntaryAnalContraction)}}(e)}},q=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.includes(NaN))throw e[e.indexOf(NaN)]+" is not a valid value";var n=e.reduce((function(e,r){return e+r}),0);return n.toString()},G=function(e,r){var n;if("all"===r?n=Object.values(e):"upper"===r?n=[e.C5,e.C6,e.C7,e.C8,e.T1]:"lower"===r&&(n=[e.L2,e.L3,e.L4,e.L5,e.S1]),!n)throw"option should be one of 'all' | 'upper' | 'lower'";if(n.some((function(e){return["NT","0*","1*","2*","3*","NT*"].includes(e)})))return"ND";var i=["0**","1**","2**","3**","4**","NT**"];return q.apply(void 0,n.map((function(e){return i.includes(e)?5:parseInt(e.replace(/\*/g,""))})))+(n.some((function(e){return i.includes(e)}))?"*":"")},H=function(e){var r=Object.values(e);if(r.some((function(e){return["NT","0*","NT*"].includes(e)})))return"ND";var n=["0**","1**","NT**"];return q.apply(void 0,r.map((function(e){return n.includes(e)?2:parseInt(e.replace(/\*/g,""))})))+(r.some((function(e){return n.includes(e)}))?"*":"")},J=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.includes("ND"))return"ND";var n=q.apply(void 0,e.map((function(e){return parseInt(e.replace(/\*/g,""))})));return n+(e.some((function(e){return e.includes("*")}))?"*":"")},Q=function(e){var r=G(e.motor,"all");return{upperExtremity:G(e.motor,"upper"),lowerExtremity:G(e.motor,"lower"),lightTouch:H(e.lightTouch),pinPrick:H(e.pinPrick),motor:r}},U=function(e,r){this.classification=z(e),this.totals=function(e){var r=Q(e.left),n=Q(e.right);return{left:r,right:n,upperExtremity:J(n.upperExtremity,r.upperExtremity),lowerExtremity:J(n.lowerExtremity,r.lowerExtremity),lightTouch:J(n.lightTouch,r.lightTouch),pinPrick:J(n.pinPrick,r.pinPrick)}}(e)};return e.ISNCSCI=U,e}({});
