var ISNCSCI=function(e){"use strict";var n=["C5","C6","C7","C8","T1","L2","L3","L4","L5","S1"],r=["C1","C2","C3","C4","C5","C6","C7","C8","T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","T11","T12","L1","L2","L3","L4","L5","S1","S2","S3","S4_5"],t=function(e){return["0","1","0*","1*","NT*"].includes(e)},i=function(e){return["0**","1**"].includes(e)},o=function(e){return["2","NT","NT**"].includes(e)},l=function(e,n,r,l){if("C1"===r)throw"invalid arguments level: "+n+" nextLevel: "+r;if("2"===e.lightTouch[r]&&"2"===e.pinPrick[r])return{continue:!0,variable:l};if(t(e.lightTouch[r])||t(e.pinPrick[r]))return{continue:!1,level:n+(l?"*":""),variable:l};if("NT"===e.lightTouch[r]||"NT"===e.pinPrick[r]){if(i(e.lightTouch[r])||i(e.pinPrick[r]))return{continue:!0,level:n+(l?"*":""),variable:!0};if(o(e.lightTouch[r])||o(e.pinPrick[r]))return{continue:!0,level:n+(l?"*":""),variable:l};throw""}return{continue:!0,variable:!0}},u=function(e){for(var n=[],t=!1,i=0;i<r.length;i++){var o=r[i],u=r[i+1];if(u){var c=l(e,o,u,t);if(t=t||!!c.variable,c.level&&n.push(c.level),c.continue)continue;break}n.push("INT"+(t?"*":""))}return n.join(",")},c=function(e){return["0","NT","0*","NT*"].includes(e)},a=function(e,n,t){return e>=r.indexOf(n)&&e<=r.indexOf(t)},f=function(e,n,r,t){if(["0","1","2"].includes(e.motor[n]))throw new Error("Invalid motor value at current level");var i={continue:!1,variable:t};return["0","1","2"].includes(e.motor[n])||["0*","1*","2*","NT*","3","4","3*","4*"].includes(e.motor[n])||["0","1","2"].includes(e.motor[r])||(i.continue=!0),["5","0**","1**","2**","3**","4**","NT**"].includes(e.motor[n])&&!["0","1","2","0*","1*","2*","NT","NT*"].includes(e.motor[r])||(["0*","1*","2*","NT*"].includes(e.motor[n])||["0**","1**","2**"].includes(e.motor[n])&&["0*","1*","2*","NT","NT*"].includes(e.motor[r])?i.level=n+"*":i.level=n+(t?"*":"")),["5","3","4","3*","4*","NT"].includes(e.motor[n])||["0**","1**","2**","3**","4**","NT**"].includes(e.motor[n])&&["0","1","2"].includes(e.motor[r])||(i.variable=!0),i},v=function(e,n,r,t){return{continue:!["0","1","2"].includes(e.motor[r]),level:["0","1","2","0*","1*","2*","NT","NT*"].includes(e.motor[r])?n+(t?"*":""):void 0,variable:t}},h=function(e,n,t){if(["0","1","2"].includes(e.motor[n]))throw new Error("Invalid motor value at current level");return function(e,n,r,t){var i={continue:!0,variable:r};return"NT"===e.motor[n]||!["3","4","0*","1*","2*","3*","4*","NT*"].includes(e.motor[n])&&t.continue||(i.continue=!1),["5","0**","1**","2**","3**","4**","NT**"].includes(e.motor[n])&&t.continue&&!t.level||(["0*","1*","2*","NT*"].includes(e.motor[n])||["0**","1**","2**"].includes(e.motor[n])&&(t.level||!t.continue)?i.level=n+"*":i.level=n+(r?"*":"")),(["0*","1*","2*","NT*","0**","1**","2**"].includes(e.motor[n])||["3**","4**","NT**"].includes(e.motor[n])&&t.continue||"5"===e.motor[n]&&t.continue&&t.variable&&!t.level)&&(i.variable=!0),i}(e,n,t,function(e,n){for(var t=r.indexOf(n)-1,i={continue:!0,variable:!1},o=t;o<=t+5;o++){var u=r[o],c=r[o+1],a=l(e,u,c,!1);!1===a.continue&&(i.continue=!1),a.level&&(i.level=a.level),a.variable&&(i.variable=!0)}return i}(e,"T1"===n?"C5":"L2"))},s=function(e){for(var t,i,o,u=[],c=!1,s=0;s<r.length;s++){if(t=r[s],i=r[s+1],a(s,"C1","C3")||a(s,"T2","T12")||a(s,"S2","S3"))o=l(e,t,i,c);else if("C4"===t||"L1"===t)o=v(e,t,i="C4"===t?"C5":"L2",c);else if(a(s,"C5","C8")||a(s,"L2","L5")){var T=s-(a(s,"C5","C8")?4:16);o=f(e,t=n[T],i=n[T+1],c)}else o="T1"===t||"S1"===t?h(e,t,c):{continue:!1,level:"INT"+(c?"*":""),variable:c};if(c=c||o.variable,o.level&&u.push(o.level),!o.continue)return u.join(",")}return u.join(",")};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
function T(){for(var e=0,n=0,r=arguments.length;n<r;n++)e+=arguments[n].length;var t=Array(e),i=0;for(n=0;n<r;n++)for(var o=arguments[n],l=0,u=o.length;l<u;l++,i++)t[i]=o[l];return t}var g=function(e){return"0"===e},p=function(e,n){if("C1"===n)throw"invalid argument level: "+n;var r=g(e.pinPrick[n]),t=g(e.lightTouch[n]);return r&&t?{continue:!0,variable:!1}:c(e.pinPrick[n])&&c(e.lightTouch[n])?{continue:!0,level:n,variable:!1}:{continue:!1,level:n,variable:!1}},d=function(e,n){var t=[];if(("No"===n||"NT"===n)&&c(e.lightTouch.S4_5)&&c(e.pinPrick.S4_5)){var i=p(e,"S4_5");"NT"!==n&&("No"!==n||i.continue&&void 0===i.level)||t.push("NA");for(var o=[],l=r.indexOf("S3");l>=0;l--){var u=r[l];if(r[l-1]){var a=p(e,u);if(a.level&&o.unshift(a.level),a.continue)continue;break}o.unshift(u)}return(t=T(t,o)).join(",")}return"NA"},N=function(e){return["2","NT","0**","1**","NT**"].includes(e)},m=function(e,n){return"0"===e.motor[n]?{continue:!0,variable:!1}:(r=e.motor[n],["NT","0*","NT*"].includes(r)?{continue:!0,level:n,variable:!1}:{continue:!1,level:n,variable:!1});var r},C=function(e,n){if("C1"===n)throw"invalid argument level: "+n;var r=N(e.lightTouch[n]),t=N(e.pinPrick[n]);return r&&t?"NT"===e.lightTouch[n]||"NT"===e.pinPrick[n]?{continue:!0,level:n,variable:!1}:{continue:!1,level:n,variable:!1}:{continue:!0,variable:!1}},S=function(e,t){if("Yes"===t)return"NA";for(var i=[],o="S4_5",l=r.indexOf("C2");l<r.length;l++)if(a(l,"C5","T1")||a(l,"L2","S1")){var u=l-(a(l,"C5","T1")?4:16),c=n[u];if(v=e.motor[c],!["5","NT","0**","1**","2**","3**","4**","NT**"].includes(v)){o=r[l-1];break}if(!N(e.lightTouch[c])||!N(e.pinPrick[c])){o=r[l-1];break}}else{var f=r[l];if("C1"===f)throw"invalid argument level: "+f;if(!N(e.lightTouch[f])||!N(e.pinPrick[f])){o=r[l-1];break}}var v,h=[],s=void 0,g={continue:!0,variable:!1};("NT"===t||"No"===t&&"S4_5"===o)&&(i.push("NA"),g=C(e,"S4_5"));for(l=r.indexOf("S3");l>=0&&g.continue;l--){if(s=r[l],a(l,"C2","C4")||a(l,"T2","L1")||a(l,"S2","S3"))g=a(l,"C2",o)?C(e,s):{continue:!0,variable:!1};else if(a(l,"C5","T1")||a(l,"L2","S1")){u=l-(a(l,"C5","T1")?4:16);g=m(e,s=n[u])}else g={continue:!1,level:"C1",variable:!1};g.level&&h.unshift(g.level)}return e.lowestNonKeyMuscleWithMotorFunction&&function(e,n){if(n){var t=e.map((function(e){return r.indexOf(e.replace(/\*/,""))})),i=r.indexOf(n);return t.every((function(e){return e<=i}))}return!1}(h,e.lowestNonKeyMuscleWithMotorFunction)?e.lowestNonKeyMuscleWithMotorFunction:(i=T(i,h.sort((function(e,n){return r.indexOf(e.replace(/\*/,""))-r.indexOf(n.replace(/\*/,""))})))).join(",")},b=function(e,n,r,t){var i;return(n.level||r.level)&&(i=n.level&&r.level&&n.level.includes("*")&&r.level.includes("*")?e+"*":e+(t?"*":"")),{continue:n.continue&&r.continue,level:i,variable:t||n.variable||r.variable}},P=function(e,t,i,o){if(i.continue){var l=r.indexOf(t),u=l-(a(l,"C4","T1")?4:16),c=n[u],s=n[u+1],T="C4"===t||"L1"===t?v(e.left,t,s,o):"T1"===t||"S1"===t?h(e.left,t,o):f(e.left,c,s,o),g="C4"===t||"L1"===t?v(e.left,t,s,o):"T1"===t||"S1"===t?h(e.right,t,o):f(e.right,c,s,o),p=void 0;return(T.level||g.level)&&(p=T.level&&g.level&&T.level.includes("*")&&g.level.includes("*")?t+"*":t+(o?"*":"")),{continue:T.continue&&g.continue,level:p,variable:o||i.variable||T.variable||g.variable}}return i},k=function(e){return a(e,"C2","C4")?0:a(e,"C5","T1")?e-4:a(e,"T2","L1")?5:a(e,"L2","S1")?e-16:n.length},L=function(e){return"No"!==e.deepAnalPressure||"0"!==e.right.lightTouch.S4_5||"0"!==e.right.pinPrick.S4_5||"0"!==e.left.lightTouch.S4_5||"0"!==e.left.pinPrick.S4_5},y=function(e,t){for(var i=0,o=t.split(",");i<o.length;i++){for(var l=o[i],u=r.indexOf(l.replace("*",""))+4,c=!0,a=k(u);a<n.length;a++){if(f=e[n[a]],!["0","NT","NT*","0*"].includes(f)){c=!1;break}}if(c)return!0}var f;return!1},_=function(e,n){return L(e)&&function(e,n){return"Yes"!==e.voluntaryAnalContraction&&y(e.right.motor,n.motorRight)&&y(e.left.motor,n.motorLeft)}(e,n)},I=function(e){return["0","1","2","0*","1*","2*","NT","NT*"].includes(e)},x=function(e,t){for(var i=0,o=t.split(",");i<o.length;i++)for(var l=o[i],u=r.indexOf(l.replace("*",""))+4,c=k(u);c<n.length;c++){if("0"!==e[n[c]])return!0}return!1},w=function(e){return!["0","1","2"].includes(e)},A=function(e,t,i,o){if(function(e){return"INT"===e||"INT*"===e}(o))return"E";var l=[];return function(e){return"C"===e||"C,I"===e}(t)&&l.push("A"),_(e,i)&&l.push("B"),function(e,n){return function(e){return"No"!==e.voluntaryAnalContraction}(e)||L(e)&&(x(e.right.motor,n.motorRight)||x(e.left.motor,n.motorLeft))}(e,i)&&(function(e,t){for(var i=0,o=t.replace(/\*/g,"").split(",");i<o.length;i++)for(var l=o[i],u=r.indexOf(l),c=k(u+1),a=n.length-c,f=0,v=c;v<n.length;v++){var h=n[v];if(f+=I(e.left.motor[h])?1:0,(f+=I(e.right.motor[h])?1:0)>a)return!0}return!1}(e,o)&&l.push("C"),function(e,t){for(var i=0,o=t.replace(/\*/g,"").split(",");i<o.length;i++){var l=o[i],u=r.indexOf(l),c=k(u+1),a=n.length-c;if(0===a)return!0;for(var f=0,v=c;v<n.length;v++){var h=n[v];if(f+=w(e.left.motor[h])?1:0,(f+=w(e.right.motor[h])?1:0)>=a)return!0}}return!1}(e,o)&&l.push("D")),function(e){return e.motorLeft.includes("INT")&&e.motorRight.includes("INT")&&e.sensoryLeft.includes("INT")&&e.sensoryRight.includes("INT")}(i)&&l.push("E"),l.join(",")},O=function(e){var n=function(e){return{sensoryRight:u(e.right),sensoryLeft:u(e.left),motorRight:s(e.right),motorLeft:s(e.left)}}(e),t=function(e){for(var n=[],t=!1,i=0;i<r.length;i++){var o=r[i],u=r[i+1],c=void 0;if(u){var f=l(e.left,o,u,!1),v=l(e.right,o,u,!1);if(a(i,"C4","T1")||a(i,"L1","S1")){var h=b(o,f,v,t);c=P(e,o,h,t)}else c=b(o,f,v,t);if(t=t||c.variable,c.level&&n.push(c.level),!c.continue)break}else n.push("INT")}return n.join(",")}(e),i=function(e){var n=c(e.right.lightTouch.S4_5),r=c(e.right.pinPrick.S4_5),t=c(e.left.lightTouch.S4_5),i=c(e.left.pinPrick.S4_5);if("Yes"!==e.voluntaryAnalContraction&&"Yes"!==e.deepAnalPressure&&n&&r&&t&&i){if("No"===e.voluntaryAnalContraction&&"No"===e.deepAnalPressure){if([e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return"0"===e})))return"C";if([e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return["0","0*"].includes(e)})))return"C,I*"}else if([e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return["0","0*"].includes(e)}))&&![e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return"0"==e})))return"C*,I";return"C,I"}return"No"===e.voluntaryAnalContraction&&"No"===e.deepAnalPressure&&[e.right.lightTouch.S4_5,e.right.pinPrick.S4_5,e.left.lightTouch.S4_5,e.left.pinPrick.S4_5].every((function(e){return["0","0**"].includes(e)}))?"I*":"I"}(e);return{neurologicalLevels:n,neurologicalLevelOfInjury:t,injuryComplete:i,ASIAImpairmentScale:A(e,i,n,t),zoneOfPartialPreservations:function(e){return{sensoryRight:d(e.right,e.deepAnalPressure),sensoryLeft:d(e.left,e.deepAnalPressure),motorRight:S(e.right,e.voluntaryAnalContraction),motorLeft:S(e.left,e.voluntaryAnalContraction)}}(e)}},E=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.includes(NaN))throw e[e.indexOf(NaN)]+" is not a valid value";var r=e.reduce((function(e,n){return e+n}),0);return r.toString()},j=function(e,n){var r;if("all"===n?r=Object.values(e):"upper"===n?r=[e.C5,e.C6,e.C7,e.C8,e.T1]:"lower"===n&&(r=[e.L2,e.L3,e.L4,e.L5,e.S1]),!r)throw"option should be one of 'all' | 'upper' | 'lower'";if(r.some((function(e){return["0*","1*","2*","3*","NT*"].includes(e)})))return"ND*";if(r.some((function(e){return"NT"===e})))return"ND";var t=["0**","1**","2**","3**","4**","NT**"];return E.apply(void 0,r.map((function(e){return t.includes(e)?5:parseInt(e.replace(/\*/g,""))})))+(r.some((function(e){return t.includes(e)}))?"*":"")},D=function(e){var n=Object.values(e);if(n.some((function(e){return["0*","NT*"].includes(e)})))return"ND*";if(n.some((function(e){return"NT"===e})))return"ND";var r=["0**","1**","NT**"];return E.apply(void 0,n.map((function(e){return r.includes(e)?2:parseInt(e.replace(/\*/g,""))})))+(n.some((function(e){return r.includes(e)}))?"*":"")},R=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.includes("ND*"))return"ND*";if(e.includes("ND"))return"ND";var r=E.apply(void 0,e.map((function(e){return parseInt(e.replace(/\*/g,""))})));return r+(e.some((function(e){return e.includes("*")}))?"*":"")},M=function(e){var n=j(e.motor,"all");return{upperExtremity:j(e.motor,"upper"),lowerExtremity:j(e.motor,"lower"),lightTouch:D(e.lightTouch),pinPrick:D(e.pinPrick),motor:n}},Y=function(e){this.classification=O(e),this.totals=function(e){var n=M(e.left),r=M(e.right);return{left:n,right:r,upperExtremity:R(r.upperExtremity,n.upperExtremity),lowerExtremity:R(r.lowerExtremity,n.lowerExtremity),lightTouch:R(r.lightTouch,n.lightTouch),pinPrick:R(r.pinPrick,n.pinPrick)}}(e)};return e.ISNCSCI=Y,e}({});
